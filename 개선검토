import streamlit as st
import os
import yaml

# [ì¶”ê°€] app.py íŒŒì¼ì´ ìˆëŠ” ì‹¤ì œ ê²½ë¡œë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ëƒ…ë‹ˆë‹¤.
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
config_dir = os.path.join(BASE_DIR, "configs")

st.title("ğŸ“‚ ê²½ë¡œ ì§„ë‹¨ ë„êµ¬")

# í˜„ì¬ í”„ë¡œê·¸ë¨ì´ ë°”ë¼ë³´ëŠ” í´ë”ë¥¼ í™”ë©´ì— ì¶œë ¥ (í™•ì¸ìš©)
st.info(f"í˜„ì¬ íˆ´ì˜ ìœ„ì¹˜: {BASE_DIR}")
st.info(f"ì„¤ì • íŒŒì¼ì„ ì°¾ëŠ” ìœ„ì¹˜: {config_dir}")

# í´ë”ê°€ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤.
if not os.path.exists(config_dir):
    os.makedirs(config_dir)
    st.warning(f"âš ï¸ {config_dir} í´ë”ê°€ ì—†ì–´ì„œ ìƒˆë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.")

# í´ë” ì•ˆì˜ ëª¨ë“  íŒŒì¼ì„ ì¶œë ¥í•´ë´…ë‹ˆë‹¤.
all_files = os.listdir(config_dir)
st.write("ğŸ“ configs í´ë” ë‚´ ì „ì²´ íŒŒì¼ ë¦¬ìŠ¤íŠ¸:", all_files)

# ê·¸ ì¤‘ .yml ë˜ëŠ” .yamlë§Œ ê³¨ë¼ëƒ…ë‹ˆë‹¤.
config_files = [f for f in all_files if f.endswith(('.yml', '.yaml'))]

if not config_files:
    st.error("âŒ ì¸ì‹ ê°€ëŠ¥í•œ .yml íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤! í™•ì¥ìë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.")
    # ë§Œì•½ ë¦¬ìŠ¤íŠ¸ì— íŒŒì¼ì€ ìˆëŠ”ë° ì•ˆ ëœ¬ë‹¤ë©´ í™•ì¥ì ë¬¸ì œì¼ í™•ë¥  100%ì…ë‹ˆë‹¤.
    st.stop()

selected_config_file = st.sidebar.selectbox("1. Tool Type ì„ íƒ", config_files)

# ì´í•˜ ê¸°ì¡´ ë¡œì§...
if selected_config_file:
    with open(os.path.join(config_dir, selected_config_file), 'r', encoding='utf-8') as f:
        config = yaml.safe_load(f)
        st.success(f"âœ… {selected_config_file} ë¡œë“œ ì„±ê³µ!")
